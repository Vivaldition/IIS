## Цель работы 

 Настройка окружения и разведочный анализ данных. 

 Подготовить структуру проекта и провести разведочный анализ данных. Результаты первой лабораторной работы будут использоваться в дальнейшем цикле работ.

## Описание проекта

 Цена автомобиля зависит от множества факторов, таких как репутация марки, характеристики автомобиля, мощность двигателя, пробег и многое другое. Прогнозирование цен на автомобили — одно из основных направлений исследований в области машинного обучения. <br/>
 Данный проект анправлен на прогнозирование стоимости подержанных автомобилей.


## Запуск

1. git clone https://github.com/Vivaldition/IIS.git
2. cd IIS
3. python -m venv .venv_car_price_pred/bin/activate # установка окружения
4. .venv_car_price_pred\Scripts\activate # активация окружения
5. pip install -r requirements.txt # установка зависимостей

## Исследование данных
Находится в ./eda/eda.ipynb.

### Основные результаты:

В ходе исследования были проведены действия:

• Загрузка данных: df = pd.read_csv('../data/car_data.csv') <br/>
• Была сделана проверка на дубликаты и отсутствие значений:df.duplicated().sum(), df.isnull().sum(). Дубликатов не было обнаружено, пропущенных значений не было обнаружено <br/>
• Для столбцов 'Fuel_Type', 'Seller_Type', 'Transmission' изменен тип данных на category <br/>
• Для столбца 'Year' изменен тип данных на int16 <br/>
• Для столбцов 'Selling_Price', 'Present_Price' изменен тип данных на float32 <br/>
• Для столбцов 'Driven_kms', 'Owner' изменен тип данных на int32 <br/>
• Был создан новый признак df['Car_Age'] = 2025 - df['Year']  # Возраст автомобиля в годах <br/>

В ходе анализа были выявлены следующие закономерности:

- Год выпуска сильно влияет на цену <br/>
- Дизельные машины дороже бензиновых и газовых <br/>
- При большом пробеге цена ниже <br/>
- Автоматические КПП увеличивают стоимость машины <br/>
- Car_Age: возраст автомобиля в годах <br/>

Обработанная выборка сохранена в файле ./data/clean_car_data.pkl

## Графики

### 1. График распределения цен

```
plt.figure(figsize=(10, 6))  
sns.histplot(df['Selling_Price'], kde=True, bins=30)  
plt.title('График распределения цен на машины')  
plt.xlabel('Цена (в lakhs)')  
plt.ylabel('Количество машин')  
plt.savefig('цены_машин.png', dpi=300, bbox_inches='tight')
plt.show ()
```
![image](https://github.com/Vivaldition/IIS/blob/main/eda/цены_машин.png)

На данном графике представлена зависимость стоимости машин от их количества. По оси абцисс находится цена за машину, которая измеряется в "lakhs", а по оси ординат находится кол-во машин, которые продаются по определенной цене.

### Вывод: Большинство машин имеет стоимость ниже или равную 10 lakhs, помимо этого присутствуют и дорогие варианты машин

### 2. График цена и год выпуска

```
print("ГРАФИК 2 - ЦЕНА и ГОД ВЫПУСКА")

plt.figure(figsize=(12, 8))

colors = {'Petrol': 'purple', 'Diesel': 'red', 'CNG': 'green'}
for fuel_type in df['Fuel_Type'].unique():
    subset = df[df['Fuel_Type'] == fuel_type]
    plt.scatter(subset['Year'], subset['Selling_Price'], 
                label=fuel_type, alpha=0.7, s=60,
               color=colors[fuel_type])

plt.title('Зависимость цены от года выпуска', fontsize=16, fontweight='bold')
plt.xlabel('Год выпуска', fontsize=12)
plt.ylabel('Цена продажи (lakhs)', fontsize=12)
plt.legend(title='Тип топлива', title_fontsize=12)
plt.grid(True, alpha=0.3)

# Сохраняем график
plt.savefig('цена и год.png', dpi=300, bbox_inches='tight')
plt.show()
```
![image](https://github.com/Vivaldition/IIS/blob/main/eda/цена%20и%20год.png)

На графике представлена зависимость цены машины от года выпуска. По оси ординат находится цена за машину, которая измеряется в "lakhs", а по оси абцисс находится год выпуска машины.

### Вывод: Исходя из графика можно сделать вывод, что машины имеющие дизельный двигатель внутреннего сгорания стоят дороже, нежели машины на природном газе и машины на бензине. Также по графику видно, что чем новее машина, тем она дороже.

### 3. Корреляционная матрица

```
print("ГРАФИК 3 - КОРРЕЛЯЦИОННАЯ МАТРИЦА")

numeric_df = df.select_dtypes(include=[np.number])

plt.figure(figsize=(10, 8))  

sns.heatmap(numeric_df.corr(), 
            annot=True,     
            cmap='coolwarm', 
            center=0)       
plt.title('Корреляция между признаками')  
plt.savefig('корреляционная_матрица.png', dpi=300, bbox_inches='tight')  
plt.show()  
```
![image](https://github.com/Vivaldition/IIS/blob/main/eda/корреляционная_матрица.png)

На графике представлена тепловая карта корреляции. <br/>
Тепловая карта корреляции — это визуальное представление корреляционной матрицы, которое показывает, насколько сильна связь между различными переменными в наборе данных.Каждая ячейка тепловой карты отображает коэффициент корреляции для пары переменных. <br/>


### Вывод: Из матрицы корреляции видно, что год выпуска и текущая стоимость (Present_Price) сильно влияет- новые машины дороже и имеют наименьший пробег. Пробег (Driven_kms) и (Owner) оказывают слабое влияние на цену.

### 4. Диаграмма Тьюки цены по типу топлива

```
print("ГРАФИК 4 - ЦЕНА ПО ТИПАМ ТОПЛИВА")

plt.figure(figsize=(10, 6))

sns.boxplot(x='Fuel_Type', y='Selling_Price', data=df, 
            hue='Fuel_Type', 
            legend=False,     
            width=0.6,
            palette='Set2')

plt.title('Сравнение цен по типам топлива', fontsize=14)
plt.xlabel('Тип топлива')
plt.ylabel('Цена (lakhs)')
plt.grid(True, alpha=0.3)

plt.savefig('цена_по_типам_топлива.png', dpi=300, bbox_inches='tight')
plt.show()
```
![image](https://github.com/Vivaldition/IIS/blob/main/eda/цена_по_типам_топлива.png)

Диаграмма Тьюки - 

### Вывод: Из диаграммы Тьюки видно, что машины работающие на дизеле стоят дороже

### График зависимости цены от пробега автомобиля

```
print("ГРАФИК 5 - ЗАВИСИМОСТЬ ЦЕНЫ ОТ ПРОБЕГА")

plt.figure(figsize=(12, 8))

plt.scatter(df['Driven_kms'], df['Selling_Price'], 
            alpha=0.6,      
            s=50,           
            color='blue',   
            edgecolors='black', 
            linewidth=0.5)  


z = np.polyfit(df['Driven_kms'], df['Selling_Price'], 1)
p = np.poly1d(z)
plt.plot(df['Driven_kms'], p(df['Driven_kms']), 
         color='red', 
         linewidth=2, 
         linestyle='--',
         label='Линия тренда')

plt.title('Зависимость цены автомобиля от пробега', fontsize=16, fontweight='bold')
plt.xlabel('Пробег (км)', fontsize=12)
plt.ylabel('Цена продажи (lakhs)', fontsize=12)
plt.legend()
plt.grid(True, alpha=0.3)


plt.savefig('цена_от_пробега.png', dpi=300, bbox_inches='tight')
plt.show()
```

![image](https://github.com/Vivaldition/IIS/blob/main/eda/цена_от_пробега.png)

### Вывод: Из графика видно, что машины, которые имеют минимальный пробег, имеют наибольшую цену. А машины, у которых пробег потихоньку дотягивать или переваливать за 100.000 км, цена снижается

## Общие выводы:

### 1. Год выпуска сильно влияет на цену <br/>
### 2. Дизельные машины дороже бензиновых и газовых <br/>
### 3. При большом пробеге цена ниже <br/>
### 4. Автоматические КПП увеличивают стоимость машины <br/>
### 5. Car_Age: возраст автомобиля в годах <br/>


 
